# Simple Whisper ä½¿ç”¨æŒ‡å—

ä¸€ä¸ªç®€å•çš„è¯­éŸ³è½¬æ–‡å­—åº”ç”¨ï¼ŒåŸºäº OpenAI Whisper æ¨¡å‹ã€‚

## æ ¸å¿ƒåŠŸèƒ½

- **å®æ—¶å½•éŸ³**ï¼šä»éº¦å…‹é£å½•åˆ¶éŸ³é¢‘å¹¶å®æ—¶è½¬æ–‡å­—
- **æ–‡ä»¶è½¬å½•**ï¼šè½¬å½•å·²æœ‰çš„éŸ³é¢‘æ–‡ä»¶ (WAV, MP3, M4A, FLACç­‰)
- **éº¦å…‹é£é€‰æ‹©**ï¼šæ”¯æŒé€‰æ‹©ä¸åŒçš„éº¦å…‹é£è®¾å¤‡
- **æ¨¡å‹é€‰æ‹©**ï¼šæ”¯æŒ 5 ç§ Whisper æ¨¡å‹ (tiny, base, small, medium, large)
- **è®¾å¤‡é€‰æ‹©**ï¼šæ”¯æŒ CPUã€GPU (CUDA)ã€Apple Silicon (MPS)
- **è¯­è¨€æ”¯æŒ**ï¼šè‡ªåŠ¨æ£€æµ‹è¯­è¨€æˆ–æ‰‹åŠ¨æŒ‡å®š
- **æ‰¹é‡å¤„ç†**ï¼šæ‰¹é‡è½¬å½•æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰éŸ³é¢‘æ–‡ä»¶

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè®¾ç½®
```bash
# å®‰è£…ä¾èµ–
./setup.sh

# æˆ–æ‰‹åŠ¨å®‰è£…
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### 2. æµ‹è¯•ç³»ç»Ÿ
```bash
# è¿è¡Œç³»ç»Ÿæµ‹è¯•ï¼ˆåŒ…æ‹¬2ç§’å½•éŸ³æµ‹è¯•ï¼‰
./test_system.sh

# æˆ–åªæ£€æŸ¥ç¯å¢ƒ
source venv/bin/activate
python test_whisper.py
```

## ä½¿ç”¨æ–¹å¼

### æ–¹å¼1ï¼šå‘½ä»¤è¡Œï¼ˆæœ€çµæ´»ï¼‰
```bash
# æŸ¥çœ‹æ‰€æœ‰é€‰é¡¹
python simple_whisper.py --help

# æŸ¥çœ‹å¯ç”¨éº¦å…‹é£
python simple_whisper.py --list-audio-devices

# å½•åˆ¶10ç§’
python simple_whisper.py --record --duration 10 --model base

# ä½¿ç”¨ç‰¹å®šéº¦å…‹é£å½•åˆ¶
python simple_whisper.py --record --duration 30 --input-device 5 --model small

# è½¬å½•ç°æœ‰æ–‡ä»¶
python simple_whisper.py --audio meeting.wav --language zh --model medium

# ä½¿ç”¨GPUåŠ é€Ÿ
python simple_whisper.py --record --device cuda --model small
```

### æ–¹å¼2ï¼šäº¤äº’å¼ç•Œé¢ï¼ˆæœ€æ˜“ç”¨ï¼‰
```bash
python interactive_whisper.py
```
äº¤äº’å¼ç•Œé¢ä¼šå¼•å¯¼æ‚¨ï¼š
1. é€‰æ‹©å½•éŸ³æ¨¡å¼æˆ–æ–‡ä»¶è½¬å½•æ¨¡å¼
2. é€‰æ‹©éº¦å…‹é£è®¾å¤‡
3. é€‰æ‹© Whisper æ¨¡å‹
4. é€‰æ‹©è®¡ç®—è®¾å¤‡ (CPU/GPU)
5. é€‰æ‹©è¯­è¨€
6. è®¾ç½®å½•éŸ³æ—¶é•¿
7. å¼€å§‹è½¬å½•

### æ–¹å¼3ï¼šå¿«æ·è„šæœ¬
```bash
# å¿«é€Ÿå½•éŸ³ï¼ˆè¯¢é—®æ—¶é•¿ï¼‰
./quick_record.sh

# å¿«é€Ÿå½•éŸ³ï¼ˆæŒ‡å®šæ—¶é•¿ï¼‰
./quick_record.sh -d 60 -m small
./quick_record.sh -d 300 -o meeting

# è½¬å½•æ–‡ä»¶
./transcribe_file.sh audio.wav
./transcribe_file.sh -m small -l zh interview.mp3

# ä¼šè®®å½•åˆ¶ï¼ˆé«˜è´¨é‡ï¼‰
./record_meeting.sh
```

### æ–¹å¼4ï¼šæ‰¹é‡å¤„ç†
```bash
# è½¬å½•æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰éŸ³é¢‘æ–‡ä»¶
python batch_transcribe.py ./audio_files --model base --output-folder ./transcriptions

# é€’å½’æœç´¢å­æ–‡ä»¶å¤¹
python batch_transcribe.py ./audio_files --recursive --model small

# æŒ‡å®šæ–‡ä»¶æ ¼å¼
python batch_transcribe.py ./audio_files --extensions "wav,mp3,m4a" --language en
```

## è„šæœ¬è¯´æ˜

| è„šæœ¬æ–‡ä»¶ | ç”¨é€” | è¯´æ˜ |
|---------|------|------|
| `simple_whisper.py` | ä¸»ç¨‹åº | æ ¸å¿ƒå½•éŸ³å’Œè½¬å½•åŠŸèƒ½ |
| `interactive_whisper.py` | äº¤äº’å¼ç•Œé¢ | å¼•å¯¼å¼æ“ä½œï¼Œé€‚åˆæ–°æ‰‹ |
| `quick_record.sh` | å¿«é€Ÿå½•éŸ³ | ç®€åŒ–å½•éŸ³æµç¨‹ |
| `transcribe_file.sh` | æ–‡ä»¶è½¬å½• | ç®€åŒ–æ–‡ä»¶è½¬å½•æµç¨‹ |
| `record_meeting.sh` | ä¼šè®®å½•åˆ¶ | é’ˆå¯¹ä¼šè®®åœºæ™¯ä¼˜åŒ– |
| `batch_transcribe.py` | æ‰¹é‡å¤„ç† | å¤„ç†æ–‡ä»¶å¤¹ä¸­çš„å¤šä¸ªæ–‡ä»¶ |
| `test_system.sh` | ç³»ç»Ÿæµ‹è¯• | æµ‹è¯•æ•´ä¸ªç³»ç»Ÿæ˜¯å¦æ­£å¸¸å·¥ä½œ |
| `test_whisper.py` | åŠŸèƒ½æµ‹è¯• | Python æµ‹è¯•è„šæœ¬ |
| `example_usage.sh` | ä½¿ç”¨ç¤ºä¾‹ | æ˜¾ç¤ºå„ç§ç”¨æ³•ç¤ºä¾‹ |

## æ¨¡å‹é€‰æ‹©å»ºè®®

| æ¨¡å‹ | å¤§å° | é€Ÿåº¦ | å‡†ç¡®åº¦ | é€‚ç”¨åœºæ™¯ |
|------|------|------|--------|----------|
| `tiny` | 39M | âš¡ï¸ å¾ˆå¿« | è¾ƒä½ | å¿«é€Ÿæµ‹è¯•ã€çŸ­è¯­éŸ³ |
| `base` | 74M | å¿« | ä¸­ç­‰ | æ—¥å¸¸ä½¿ç”¨ã€ä¸€èˆ¬å½•éŸ³ |
| `small` | 244M | ä¸­ç­‰ | è‰¯å¥½ | ä¼šè®®ã€è®¿è°ˆ |
| `medium` | 769M | æ…¢ | ä¼˜ç§€ | é‡è¦ä¼šè®®ã€é«˜å‡†ç¡®åº¦è¦æ±‚ |
| `large` | 1550M | ğŸŒ å¾ˆæ…¢ | æœ€ä½³ | ç ”ç©¶ã€æœ€é«˜å‡†ç¡®åº¦ |

## è®¾å¤‡é€‰æ‹©

- **CPU**ï¼šé€šç”¨ï¼Œé€Ÿåº¦è¾ƒæ…¢
- **CUDA**ï¼šNVIDIA GPUï¼Œå¤§å¹…åŠ é€Ÿï¼ˆéœ€è¦å®‰è£… CUDAï¼‰
- **MPS**ï¼šApple Silicon GPUï¼ŒApple è®¾å¤‡åŠ é€Ÿ

## å¸¸è§é—®é¢˜

### 1. "PortAudio not found" é”™è¯¯
```bash
# macOS
brew install portaudio

# Ubuntu/Debian
sudo apt-get install portaudio19-dev python3-pyaudio
```

### 2. è½¬å½•é€Ÿåº¦æ…¢
- ä½¿ç”¨æ›´å°çš„æ¨¡å‹ (`tiny`, `base`)
- ä½¿ç”¨ GPU (`--device cuda` æˆ– `--device mps`)
- ç¼©çŸ­å½•éŸ³æ—¶é•¿

### 3. è½¬å½•å‡†ç¡®åº¦ä½
- ä½¿ç”¨æ›´å¤§çš„æ¨¡å‹ (`small`, `medium`, `large`)
- ç¡®ä¿å½•éŸ³æ¸…æ™°ï¼Œå‡å°‘èƒŒæ™¯å™ªéŸ³
- æŒ‡å®šè¯­è¨€ (`--language zh`)

### 4. æ‰¾ä¸åˆ°éº¦å…‹é£
```bash
# æŸ¥çœ‹æ‰€æœ‰éŸ³é¢‘è®¾å¤‡
python simple_whisper.py --list-audio-devices

# ä½¿ç”¨é»˜è®¤è®¾å¤‡
python simple_whisper.py --record --duration 2 --model tiny
```

## è¾“å‡ºæ–‡ä»¶

- **å½•éŸ³æ–‡ä»¶**ï¼š`recording_YYYYMMDD_HHMMSS.wav` (WAVæ ¼å¼)
- **è½¬å½•æ–‡ä»¶**ï¼š`recording_YYYYMMDD_HHMMSS_transcription.txt` æˆ–è‡ªå®šä¹‰åç§°

è½¬å½•æ–‡ä»¶åŒ…å«ï¼š
1. å®Œæ•´çš„è½¬å½•æ–‡æœ¬
2. åˆ†æ®µæ—¶é—´æˆ³ï¼ˆå¦‚æœå¯ç”¨ï¼‰
3. æ£€æµ‹åˆ°çš„è¯­è¨€ä¿¡æ¯

## é«˜çº§ç”¨æ³•

### ç»„åˆä½¿ç”¨ç¤ºä¾‹
```bash
# é«˜è´¨é‡ä¼šè®®å½•åˆ¶ï¼ˆ1å°æ—¶ï¼Œä¸­ç­‰æ¨¡å‹ï¼Œä¸­æ–‡ï¼‰
python simple_whisper.py --record --duration 3600 --model medium --language zh --output-text meeting_notes.txt

# æ‰¹é‡å¤„ç†å¹¶ä¿å­˜åˆ°æŒ‡å®šæ–‡ä»¶å¤¹
python batch_transcribe.py ./recordings --model small --output-folder ./transcripts --language en

# ä½¿ç”¨ç‰¹å®šéº¦å…‹é£å’Œé«˜ç²¾åº¦æ¨¡å‹
python simple_whisper.py --record --input-device 0 --model large --device cuda --output-audio important.wav
```

### ç¯å¢ƒå˜é‡
```bash
# è®¾ç½®PyTorchä½¿ç”¨GPUå†…å­˜æ›´é«˜æ•ˆ
export PYTORCH_CUDA_ALLOC_CONF=max_split_size_mb:128

# è®¾ç½®Whisperç¼“å­˜ç›®å½•
export WHISPER_CACHE_DIR=~/.cache/whisper
```

## è®¸å¯è¯

MIT è®¸å¯è¯

---

## è·å–å¸®åŠ©

1. æŸ¥çœ‹è¯¦ç»†å¸®åŠ©ï¼š`python simple_whisper.py --help`
2. è¿è¡Œç¤ºä¾‹ï¼š`./example_usage.sh`
3. æµ‹è¯•ç³»ç»Ÿï¼š`./test_system.sh`
4. ä½¿ç”¨äº¤äº’å¼ç•Œé¢ï¼š`python interactive_whisper.py`

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
- è™šæ‹Ÿç¯å¢ƒæ˜¯å¦æ¿€æ´»
- ä¾èµ–æ˜¯å¦å®‰è£…å®Œæ•´
- éº¦å…‹é£æ˜¯å¦æ­£å¸¸å·¥ä½œ
- ç£ç›˜ç©ºé—´æ˜¯å¦è¶³å¤Ÿ